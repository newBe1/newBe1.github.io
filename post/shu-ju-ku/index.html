<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    YAN · RUI
</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://newbe1.github.io/">
<link rel="dns-prefetch" href="https://cdn.bootcss.com">
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<meta name="author" content="YANRUI">
<meta name="description" content="Good morning good afternoon good night">
<meta name="keywords" content="保持饥饿">
<link rel="stylesheet" href="https://newbe1.github.io//media/css/style.min.css" />
<link rel="stylesheet" href="https://newbe1.github.io//styles/main.css" />
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.0/dist/APlayer.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.0/dist/APlayer.min.css">
    
        <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>
        <script src="https://newbe1.github.io//media/script/tocbot.min.js"></script>
        <script src="https://newbe1.github.io//media/script/script.min.js"></script>
        <script src="https://newbe1.github.io//media/script/icon.min.js"></script>
        <script src="https://cdn.bootcss.com/highlight.js/9.13.1/highlight.min.js"></script>
        <link href="https://cdn.bootcss.com/highlight.js/9.13.1/styles/atelier-estuary-dark.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
        
            <script>
                (function() {
                    var bp = document.createElement('script');
                    var curProtocol = window.location.protocol.split(':')[0];
                    if (curProtocol === 'https') {
                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                    } else {
                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                    }
                    var s = document.getElementsByTagName("script")[0];
                    s.parentNode.insertBefore(bp, s);
                })();
            </script>
            
                
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://newbe1.github.io/">
                    YAN · RUI
                </a>
            </div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="https://newbe1.github.io/">
                        首页
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        归档
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        标签
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        关于
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://newbe1.github.io/">
                            YAN · RUI
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;\u6697\u9ED1</a>
                    </div>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="https://newbe1.github.io/">
                            首页
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            归档
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            标签
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            关于
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                数据库
                            </h1>
                            <!--en-->
                            <div class="post-meta en">
                                Author:
                                <a itemprop="author" rel="author" href="/">
                                    YAN · RUI
                                </a>
                                <span class="post-time">
                                Date: <a href="#">2020-01-12</a>
                            </span>
                                <span class="post-readtime">Reading Time:<a href="#">4.8 mins</a></span>
                                <span class="post-words">words:<a href="#">1328</a></span>
                                
                            </div>
                            <!--zh-->
                            <div class="post-meta zh">
                                &#x4F5C;&#x8005;:
                                <a itemprop="author" rel="author" href="/">
                                    YAN · RUI
                                </a>
                                <span class="post-time">&#x65E5;&#x671F;: <a href="#">2020-01-12</a></span>
                                <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a href="#">4.8 &#x5206;&#x949F;</a></span>
                                <span class="post-words">&#x5B57;&#x6570;:<a href="#">1328</a></span>
                                
                            </div>
                        </header>
                        <div class="post-content">
                            <h2 id="数据库">数据库</h2>
<h3 id="数据库性能优化"><strong>数据库性能优化</strong></h3>
<p><em>sql优化</em>：</p>
<p>​			少使用select*；</p>
<p>​			只查询一条记录时使用 limit 1；</p>
<p>​			使用连接查询代替子查询；</p>
<p>​			尽量使用一些能通过索引查询的关键字；</p>
<p><em>表结构优化</em>：</p>
<p>​			尽量使用数字类型的字段，提高比对效率；</p>
<p>​			长度不变且对查询速度要求高的数据可以考虑使用 char，否则使用 varchar；</p>
<p>​			表中字段过多时可以适当的进行垂直分割，将部分字段移动到另外一张表；</p>
<p>​			表中数据量过大可以适当的进行水平分割，将部分数据移动到另外一张表。</p>
<p><em>其他优化</em>：</p>
<p>​			 对查询效率高的字段适当建立索引提高效率；</p>
<p>​			根据表的用途使用合适的数据库引擎，读写分离；</p>
<h3 id="索引"><strong>索引</strong></h3>
<p><u>like以%开头会导致索引失效而进行全局扫描</u></p>
<p>mysql查询的方式 即访问类型有</p>
<p>ALL：全表扫描</p>
<p>index：索引全扫描</p>
<p>range：索引范围扫描</p>
<p>ref：使用非唯一索引扫描</p>
<p>eq_ref：使用唯一索引扫描</p>
<p>const，system：单表中 最多只有一个匹配行</p>
<p>（性能越来越好）</p>
<p><strong>作用</strong></p>
<p>快速访问表中的特定信息，提高查询速度</p>
<p>创建唯一索引，确保数据的唯一性</p>
<p>加速表和表之间的联系</p>
<p>减少查询中分组和排序的时间</p>
<p><strong>分类</strong></p>
<p>主键索引（PRIMAY KEY）</p>
<p>唯一索引（UNIQUE）</p>
<p>常规索引（INDEX）</p>
<p>全文索引（FULLTEXT）</p>
<p><strong>负面影响</strong></p>
<p>创建索引和维护索引需要耗费时间，这个时间随着数据量的增加而增加，同时索引也需要占用物理空间，当对表进行操作的时候索引也要进行动态维护，会降低数据的维护速度</p>
<p><strong>创建索引的原则</strong></p>
<p>在频繁使用，用以缩小查询范围的字段或者用以排序的字段上建立索引</p>
<p>对应很少涉及查询的列或重复值较多的列，不宜创建索引</p>
<p>对于特殊的数据类型的列，不宜创建索引如（text）</p>
<h3 id="mysql的事务隔离级别"><strong>MySql的事务隔离级别</strong></h3>
<p><strong>Read uncommitted</strong>  ：读未提交  <u><strong>脏读</strong></u> 一个事务可以读取另一个未提交的事务的数据  可用读提交解决</p>
<p><strong>Read committed</strong> ：读提交  一个事务要等另一个事务提交后才能读取数据，但会出现一个事务范围内两个相同的查询出现不同的结果 这就是 <u><strong>不可重复读</strong></u> ，可用重复读解决这个问题</p>
<p><strong>Repeatable read</strong> ：重复读 在开始读取数据时（事务开启时） ， 不容许修改操作，可能出现<strong>幻读</strong> 当用户读取某一范围的数据行时，另一个事务又在该范围插入了新数据，用户再读取该范围的数据时会出现幻影行 <strong>Mysql的默认事务隔离级别</strong></p>
<p><strong>Serializable</strong> ：串行化 序列化 一个事务一个事务地执行，<strong>会导致大量超时现象和锁竞争</strong></p>
<p><u>不可重复读主要侧重于修改，幻读主要侧重于增删。解决不可重复读锁住满足条件的行，解决幻读需锁表</u></p>
<table>
<thead>
<tr>
<th>事务隔离级别</th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻读</th>
</tr>
</thead>
<tbody>
<tr>
<td>读未提交（read uncommitted）</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>读提交（read committed）</td>
<td>否</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>重复度（repeatable read）</td>
<td>否</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>串行化（serializable）</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
</tbody>
</table>
<h3 id="mysql锁概述">MySql锁概述</h3>
<p>**表级锁：**开销小，加锁快；不会出现死锁；锁定粒度大，发生锁冲突的概率最高，并发度最低。<br>
**行级锁：**开销大，加锁慢；会出现死锁；锁定粒度最小，发生锁冲突的概率最低，并发度也最高。<br>
**页面锁：**开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定粒度界于表锁和行锁之间，并发度一般</p>
<p>不同的存储引擎支持不同的锁机制</p>
<p>MyISAM和MEMORY采用表级锁</p>
<p>BDB存储引擎采用的是页面锁（page-level locking），但也支持表级锁</p>
<p>InnoDB存储引擎既支持行级锁（row-level locking），也支持表级锁，但默认情况下是采用行级锁</p>
<h3 id="五大约束">五大约束</h3>
<p>1.—-主键约束（Primay Key Coustraint） 唯一性，非空性</p>
<p>2.—-唯一约束 （Unique Counstraint）唯一性，可以空，但只能有一个</p>
<p>3.—-检查约束 (Check Counstraint) 对该列数据的范围、格式的限制（如：年龄、性别等）</p>
<p>4.—-默认约束 (Default Counstraint) 该数据的默认值</p>
<p>5.—-外键约束 (Foreign Key Counstraint) 需要建立两表间的关系并引用主表的列</p>
<p><em><strong>示例</strong></em></p>
<p>五大约束的语法示例</p>
<p>1.—-添加主键约束（将stuNo作为主键）</p>
<p>alter table stuInfo</p>
<p>add constraint PK_stuNo primary key (stuNo)</p>
<p>2.—-添加唯一约束（身份证号唯一，因为每个人的都不一样）</p>
<p>alter table stuInfo</p>
<p>add constraint UQ_stuID unique(stuID)</p>
<p>3.—-添加默认约束（如果地址不填 默认为“地址不详”）</p>
<p>alter table stuInfo</p>
<p>add constraint DF_stuAddress default (‘地址不详’) for stuAddress</p>
<p>4.—-添加检查约束 （对年龄加以限定 15-40岁之间）</p>
<p>alter table stuInfo</p>
<p>add constraint CK_stuAge check (stuAge between 15 and 40)</p>
<p>alter table stuInfo</p>
<p>add constraint CK_stuSex check (stuSex=’男’ or stuSex=’女′)</p>
<p>5.—-添加外键约束 (主表stuInfo和从表stuMarks建立关系，关联字段stuNo)</p>
<p>alter table stuInfo</p>
<p>add constraint FK_stuNo foreign key(stuNo)references stuinfo(stuNo)</p>

                        </div>
                        <div class="post-toc">
                            <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93">数据库</a>
<ul>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><strong>数据库性能优化</strong></a></li>
<li><a href="#%E7%B4%A2%E5%BC%95"><strong>索引</strong></a></li>
<li><a href="#mysql%E7%9A%84%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><strong>MySql的事务隔离级别</strong></a></li>
<li><a href="#mysql%E9%94%81%E6%A6%82%E8%BF%B0">MySql锁概述</a></li>
<li><a href="#%E4%BA%94%E5%A4%A7%E7%BA%A6%E6%9D%9F">五大约束</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                        </div>
                        <section class="post-copyright en">
                            <!--en-->
                            <p class="copyright-item">
                                <span>Author:</span>
                                <span>YAN · RUI</span>
                            </p>

                            <p class="copyright-item">
                                <span>Permalink:</span>
                                <span><a href="https://newbe1.github.io/post/shu-ju-ku">https://newbe1.github.io/post/shu-ju-ku</a></span>
                            </p>

                            <p class="copyright-item">
                                <span>License:</span>
                                <span>MIT License</span>
                            </p>
                        </section>
                        <section class="post-copyright zh">
                            <!--zh-->
                            <p class="copyright-item ">
                                <span>&#x4F5C;&#x8005;:</span>
                                <span>YAN · RUI</span>
                            </p>

                            <p class="copyright-item">
                                <span>&#x6C38;&#x4E45;&#x94FE;&#x63A5;:</span>
                                <span><a href="https://newbe1.github.io/post/shu-ju-ku">https://newbe1.github.io/post/shu-ju-ku</a></span>
                            </p>

                            <p class="copyright-item">
                                <span>&#x534F;&#x8BAE;:</span>
                                <span>MIT License</span>
                            </p>
                        </section>
                        <!--en-->
                        <section class="post-tags en">
                            <div>
                                <span>Tag(s):</span>
                                <span class="tag">
                                
                            </span>
                            </div>
                            <div>
                                <a href="javascript:window.history.back();">back</a>
                                <span>&dot;</span>
                                <a href="#">home</a>
                            </div>
                        </section>
                        <!--zh-->
                        <section class="post-tags zh">
                            <div>
                                <span>&#x6807;&#x7B7E;:</span>
                                <span class="tag">
                                
                            </span>
                            </div>
                            <div>
                                <a href="javascript:window.history.back();">
                                &#x8FD4;&#x56DE;</a>
                                <span>&dot;</span>
                                <a href="#">&#x4E3B;&#x9875;</a>
                            </div>
                        </section>
                        <section class="post-nav">
                            
                                    
                                        <a class="next" rel="next" href="https://newbe1.github.io/post/linux">
                                            linux
                                        </a>
                                        
                        </section>
                    </article>
                </div>
                
            </div>
    </div>
    </div>
    </div>
    
    <div id="player"></div>
    
        <footer id="footer" class="footer">

            <div class="copyright">
                <div class="Like">
                    <div class="tip" data-tooltip="Do you like it?">
                        <a href="https://github.com/ITJoker233/Gridea-theme-Chic" target="_blank" title=""><svg class="icon"
                        aria-hidden="true">
                        <use xlink:href="#like"></use>
                    </svg><b class="like_text" id="star"></b></a>
                    </div>
                </div>
                Powered by <a href="https://github.com/newBe1/newBe1.github.io">YAN</a>
                    <b id="hitokoto"></b><br>
                    <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                    YAN · RUI &copy;Copyright
                        <script>
                            var date = new Date();
                            document.write("" + date.getFullYear());
                        </script>
                        | Powered by <a href="https://coding.net" target="_blank">Coding.net</a>
            </div>
            <div id="update" style="display:none;">
                on
            </div>
            
                <div id="version" style="display:none;">
                    1.5.8
                </div>
                
                    <script>
                        var pat = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + pat + '</div>')
                    </script>

        </footer>
        
            <script src='https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js'></script>
            
                <script>
                    

                    function LoadPlayer() {
                        var audio_name = '';
                        var audio_artist = '';
                        var audio_url = '';
                        var audio_cover = '';
                        const ap = new APlayer({
                            container: document.getElementById('player'),
                            fixed: true,
                            audio: [{
                                name: audio_name,
                                artist: audio_artist,
                                url: audio_url,
                                cover: audio_cover,
                            }]
                        });

                    }
                    LoadPlayer();
                    
                    
                    loadlive2d();
                    
                    hitokoto();
                    getStar();
                    hljs.initHighlighting();
                    //console.clear();
                    CheckVersion();
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
        </div>
</body>
<script>
    scroll();
</script>

</html>